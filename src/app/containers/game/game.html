<div class="container">
  <header class="header">
    <h1 class="title">Memories words</h1>
  </header>
  <div *ngIf="!gameConfig && !isModalShow" class="game-config">
    <button class="btn btn-white mb-40" (click)="initGame(gameTypeEnum.STUDY)">Study</button>
    <button class="btn btn-purple" (click)="initGame(gameTypeEnum.TEST)">Start test</button>
  </div>
  <div *ngIf="gameConfig" class="game-section">
    <div class="game-field background-wrapper">
      <div class="column" *ngFor="let wordsColumn of wordsColumns; let columnIndex = index">
        <ng-container *ngFor="let word of wordsColumn">
          <button
            [disabled]="!word.isVisible || !instance?.isGameRunning() || (columnIndex === 1 && !selectedWord)"
            class="btn btn-word"
            [class.opacity-zero]="!word.isVisible"
            [class.btn-scale]="columnIndex === 0 && this.selectedWord?.id === word.id || columnIndex === 1 && this.selectedTranslateWord?.id === word.id"
            [class.btn-not-equal]="notEqual.isNotEqual && (columnIndex === 0  && notEqual.selectedWordId === word.id) || (columnIndex === 1  && notEqual.selectedTranslateWordId === word.id)"
            [class.btn-equal]="!notEqual.isNotEqual && notEqual.selectedWordId === word.id"
            (click)="clickToWord(columnIndex, word)">
            <span *ngIf="columnIndex === 0">
              {{word.word.toLowerCase()}}
            </span>
            <span *ngIf="columnIndex === 1">
              {{word.translateWord.toLowerCase()}}
            </span>
          </button>
        </ng-container>
      </div>
    </div>
    <div class="game-control-wrapper">
      <div class="game-statistic">
        <div
          *ngIf="instance.gameType === gameTypeEnum.TEST"
          class="background-wrapper statistic-item-wrapper">
          <span class="statistic-item-label">
            timer:
          </span>
          <span class="statistic-item-value">
            {{timerCounter}}
          </span>
        </div>
        <div
          *ngIf="instance.gameType === gameTypeEnum.TEST"
          class="background-wrapper statistic-item-wrapper">
          <span class="statistic-item-label">
            words:
          </span>
          <span class="statistic-item-value">
            {{wordsProgress}} / {{sizeWordsRange}}
          </span>
        </div>
        <div
          class="background-wrapper statistic-item-wrapper">
          <span class="statistic-item-label">
            score:
          </span>
          <span class="statistic-item-value">
            {{score}}
          </span>
        </div>
      </div>
      <div class="game-control">
        <div
          *ngIf="gameConfig"
          class="testGameControl">
          <button
            *ngIf="!instance?.isGameRunning()"
            class="btn btn-white"
            (click)="runGame()">Start
          </button>
          <button
            *ngIf="instance?.isGameRunning()"
            class="btn btn-white"
            (click)="stopGame()">Finish
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<div
  *ngIf="isModalShow" (click)="isModalShow = false"
  class="modal">
  <div
    class="modal-dialog"
    (click)="$event.stopPropagation()">
    <div class="modal-content">
      <div class="modal-header">
        <p class="modal-title">
          Result
        </p>
        <button
          type="button"
          class="btn-close"
          aria-label="Close"
          (click)="isModalShow = false">
          X
        </button>
      </div>
      <div class="modal-body">
        <div class="statistic-item-wrapper">
          <span class="statistic-item-label">
          Your score:
          </span>
          <span class="statistic-item-value">
         {{score}}
          </span>
        </div>
        <div class="statistic-item-wrapper">
          <span class="statistic-item-label">
            Words:
          </span>
          <span
            *ngIf="instance.gameType === gameTypeEnum.TEST"
            class="statistic-item-value">
           {{wordsProgress}} / {{sizeWordsRange}}
          </span>
          <span
            *ngIf="instance.gameType === gameTypeEnum.STUDY"
            class="statistic-item-value">
           {{wordsProgress}}
          </span>
        </div>
        <div
          *ngIf="instance.gameType === gameTypeEnum.TEST"
          class="statistic-item-wrapper">
          <span class="statistic-item-label">
            Wrong:
          </span>
          <span class="statistic-item-value">
           {{mistake}}
          </span>
        </div>
        <div class="statistic-item-wrapper">
          <span class="statistic-item-label">
            Mistake:
          </span>
          <span
            *ngIf="mistake && instance.gameType === gameTypeEnum.TEST"
            class="statistic-item-value">
           {{mistake}} - {{mistake / (mistake + wordsProgress) * 100 | number : '1.0-0'}}%
          </span>
          <span
            *ngIf="!mistake  && instance.gameType === gameTypeEnum.TEST"
            class="statistic-item-value">
           {{mistake}}%
          </span>
          <span
            *ngIf="instance.gameType === gameTypeEnum.STUDY"
            class="statistic-item-value">
           {{mistake}}
          </span>
        </div>
        <div
          *ngIf="instance.gameType === gameTypeEnum.TEST"
          class="statistic-item-wrapper">
          <span class="statistic-item-label">
            Time:
          </span>
          <span class="statistic-item-value">
           {{totalGameTime | date : 'mm:ss'}}
          </span>
        </div>
        <div
          *ngIf="instance.gameType === gameTypeEnum.TEST"
          class="statistic-item-wrapper">
          <span class="statistic-item-label">
            Av. answer time:
          </span>
          <span class="statistic-item-value">
           {{totalGameTime.getSeconds() / (mistake + wordsProgress) | number : '1.0-2'}} sec
          </span>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn-close"
          (click)="isModalShow = false">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
